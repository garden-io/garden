---
order: 1
title: Deprecations and major-version updates
---

# Deprecations and major-version updates

The next major version of Garden, 0.14, will contain breaking changes. To make the update as seamless as possible for
your team, avoid functionality that has been deprecated in Garden 0.13.

When using `apiVersion: garden.io/v1` in your project configuration file, Garden will warn you if your configuration
depends on features that will be removed in Garden 0.14.

**EXPERIMENTAL**: You can opt-in to the new behaviour in Garden 0.14 by using `apiVersion: garden.io/v2`. This setting
will make Garden throw errors whenever it detects usage of deprecated functionality.

{% hint style="warning" %}
Please note that as of today, not all warnings are in place, so we are still working on the list of breaking changes.
Once the list of breaking changes is final, we will make this known here.
{% endhint %}

# Breaking changes

   <!-- DO NOT CHANGE BELOW - AUTO-GENERATED -->
   <!-- This section is auto-generated by `npm run generate-docs`. Any changes above these comments will be preserved. Make changes to deprecations in `deprecations.ts`. -->

   ## Kubernetes provider configuration

<h3 id="containerDeploymentStrategy">The <code>deploymentStrategy</code> config field</h3>

Do not use this config field. It has no effect as the experimental support for blue/green deployments (via the `blue-green` strategy) has been removed.

## Project configuration

<h3 id="dotIgnoreFiles">The <code>dotIgnoreFiles</code> config field</h3>

Use the `dotIgnoreFile` field instead. It only allows specifying one filename.

For more information, please refer to the [`dotIgnoreFile` reference documentation](../reference/project-config.md#dotIgnoreFile).

<h3 id="apiVersionV0">Using <code>apiVersion: garden.io/v0</code> in the project config</h3>

Use `apiVersion: garden.io/v1` or higher instead.

Using `apiVersion: garden.io/v0`, or not specifying `apiVersion` at all in the project configuration, indicates the configuration has been written for Garden version 0.12 (Acorn).

To indicate that your configuration has been written for Garden 0.13 (Bonsai), use `apiVersion: garden.io/v1` instead.

Full Example:
```yaml
# project.garden.yml
apiVersion: garden.io/v1 # <-- This indicates that the configuration has been written for Garden 0.13 (Bonsai).
kind: Project
name: garden-core

environments:
- name: dev

providers:
- name: local-kubernetes
```

For more information, please refer to the [`apiVersion` reference documentation](../reference/project-config.md#apiVersion).

<h3 id="projectConfigModules">The <code>modules</code> config field</h3>

Do not use the `modules` field, as it has been renamed to `scan`. Please use the `scan` field instead.

For more information, please refer to the [`scan` reference documentation](../reference/project-config.md#scan).

## Garden commands

<h3 id="kubernetesClusterInitCommand"><code>garden kubernetes cluster-init</code></h3>

Do not use this command. It has no effect.

<h3 id="syncStartCommand"><code>garden sync start</code></h3>

The command `garden sync start` will only be available inside the dev console (`garden dev`) in the next major version of Garden, 0.14. Do not use it as a standalone Garden command.

Please run `garden deploy --sync` instead, to start the dev console.

You can also start the dev console by running `garden dev` and then use the `sync start` command inside the dev shell. The same applies to all other sync commands.

<h3 id="syncStopCommand"><code>garden sync stop</code></h3>

The command `garden sync stop` will only be available inside the dev console (`garden dev`) in the next major version of Garden, 0.14. Do not use it as a standalone Garden command. Instead, we recommend running `garden deploy --sync`, or alternatively starting syncs inside the dev console (`garden dev`) using `sync stop`.

<!-- markdown-link-check-disable-next-line -->
See also [the deprecation notice for the `garden sync start` command](#syncStartCommand).

<h3 id="syncRestartCommand"><code>garden sync restart</code></h3>

The command `garden sync restart` will only be available inside the dev console (`garden dev`) in the next major version of Garden, 0.14. Do not use it as a standalone Garden command.

<!-- markdown-link-check-disable-next-line -->
See also [the deprecation notice for the `garden sync start` command](#syncStartCommand).

<h3 id="syncStatusCommand"><code>garden sync status</code></h3>

The command `garden sync status` will only be available inside the dev console (`garden dev`) in the next major version of Garden, 0.14. Do not use it as a standalone Garden command.

<!-- markdown-link-check-disable-next-line -->
See also [the deprecation notice for the `garden sync start` command](#syncStartCommand).

## Garden Plugins

<h3 id="hadolintPlugin">The <code>hadolint</code> plugin</h3>

Do not use the `hadolint` plugin explicitly, as it will be removed in the next version of Garden, 0.14.

[Hadolint](https://github.com/hadolint/hadolint) is a Dockerfile linter written in Haskell. It can be used to enforce best practices.

If you want to keep using hadolint, you can use an `exec` action instead:

```yaml
kind: test
type: exec
name: dockerfile-hadolint
include: ["Dockerfile"]
spec:
 command: [hadolint, "Dockerfile"]
```

<h3 id="octantPlugin">The <code>octant</code> plugin</h3>

Do not use the `octant` plugin explicitly, as it will be removed in the next version of Garden, 0.14.

The `octant` plugin does not have any effect since the integrated dashboard has been removed in Garden 0.13.0.

<h3 id="conftestPlugin">The <code>conftest</code> plugin</h3>

Do not use the `conftest` plugin explicitly, as it will be removed in the next version of Garden, 0.14.

[Conftest](https://www.conftest.dev/) is a utility to help you write tests against structured configuration data.

If you want to keep using conftest, you can use an `exec` action instead:

```yaml
kind: test
type: exec
name: conftest
include:
- "policy/**/*.rego"
- deployment.yaml
spec:
 command: [conftest, test, deployment.yaml]
```

<h3 id="ephemeralKubernetesProvider">The <code>ephemeral-kubernetes</code> provider of the <code>kubernetes</code> plugin</h3>

Use `kubernetes` or `local-kubernetes` providers instead. We are currently exploring how to improve and offer a new hosted Kubernetes experience in the future â€“ reach out on GitHub or Discord if you are interested or have any feedback!

## Local mode

<h3 id="localMode">Using <code>spec.localMode</code> in <code>helm</code>, <code>kubernetes</code> and <code>container</code> deploy actions</h3>

The local mode will be removed in the next major version of Garden, 0.14.

Use the `sync mode` instead. You can also consider using [mirrord](https://mirrord.dev/) or [telepresence](https://www.telepresence.io/).

See also:
- [`spec.localMode` in the `kubernetes` deploy action reference](../reference/action-types/Deploy/container.md#spec.localmode).
- [`spec.localMode` in the `helm` deploy action reference](../reference/action-types/Deploy/helm.md#spec.localmode).
- [`spec.localMode` in the `container` deploy action reference](../reference/action-types/Deploy/container.md#spec.localmode).

## Action configs

<h3 id="buildConfigFieldOnRuntimeActions">The <code>build</code> config field in runtime action configs</h3>

Use `dependencies` config build to define the build dependencies.

Please replace all root-level configuration entries like `build: my-app` with the `dependencies: [build.my-app]`.

For example, a configuration like

```yaml
kind: Build
name: backend
description: Backend service container image
type: container

---
kind: Deploy
name: backend
description: Backend service container
type: container
build: backend # <-- old config style uses `build` field

spec:
image: ${actions.build.backend.outputs.deploymentImageId}
...
```

should be replaced with

```yaml
kind: Build
name: backend
description: Backend service container image
type: container

---
kind: Deploy
name: backend
description: Backend service container
type: container

# use `dependencies` field instead of the `build`
dependencies:
- build.backend

spec:
image: ${actions.build.backend.outputs.deploymentImageId}
...
```

## Build Staging

<h3 id="rsyncBuildStaging"><code>rsync</code>-based build staging</h3>

Do not use `GARDEN_LEGACY_BUILD_STAGE` environment variable in 0.14.

Using the `rsync`-based build staging is not necessary when using the latest versions of Garden.

If you still need to use this environment variable for some reason, please reach out to us on GitHub, Discord or via the customer support.

## Garden action types

<h3 id="configmapDeployAction">The <code>configmap</code> deploy action type</h3>

The `configmap` deploy action type will be removed in the next major version of Garden, 0.14. Please use the `kubernetes` deploy action type with a `configmap` Kubernetes manifest instead.

Example:

```yaml
# garden.yml
kind: Deploy
type: kubernetes
name: game-demo-configmap
spec:
 manifests:
   - apiVersion: v1
     kind: ConfigMap
     metadata:
       name: game-demo
     data:
       player_initial_lives: "3"
       ui_properties_file_name: "user-interface.properties"
       game.properties: |
         enemy.types=aliens,monsters
         player.maximum-lives=5
       user-interface.properties: |
         color.good=purple
         color.bad=yellow
         allow.textmode=true
```

<h3 id="persistentvolumeclaimDeployAction">The <code>persistentvolumeclaim</code> deploy action type</h3>

The `persistentvolumeclaim` deploy action type will be removed in the next major version of Garden, 0.14. Please use the `kubernetes` deploy action type instead.

For more information how to use Persistent Volume Claims using Kubernetes manifests, refer to the [official Kubernetes documentation on configuring persistent volume storage](https://kubernetes.io/docs/tasks/configure-pod-container/configure-persistent-volume-storage/).

## Template Language

<h3 id="optionalTemplateValueSyntax">The optional template value syntax (like <code>${var.foo}?</code>)</h3>

Use explicit fallback values instead, e.g. `${var.foo || "defaultValue"}`.

There were some issues with the syntax for optional template values in the template language.

For example, what do you expect the following template to evaluate to:

```yaml
# ...
variables:
 baseUrl: https://example.com/
 fullUrl: ${var.baseUrl}?param=xyz # <-- users expect this to evaluate to https://example.com/?param=xyz
```

When using `apiVersion: garden.io/v1`, the question mark is considered part of the template expression and thus `fullUrl` evaluates to `https://example.com/param=xyz` and there is no error if `var.baseUrl` doesn't exist.

When using `apiVersion: garden.io/v2`, the question mark operator has been removed and thus `fullUrl` evaluates to `https://example.com/?param=xyz` and resolving the action will fail if `var.baseUrl` doesn't exist.

## Default configuration values

<h3 id="waitForJobs"><code>spec.waitForJobs</code> of <code>kubernetes Deploy</code></h3>

The new default value is `true`

This means that deploy actions will wait for jobs to complete by default when applying Job manifests. For more information about jobs, please refer to the [official Kubernetes documentation on Jobs](https://kubernetes.io/docs/concepts/workloads/controllers/job/).